<!DOCTYPE html>
<html>
	<head>
		<title>Practical JavaScript</title>
	</head>
	<body>
		<button id="toggle-all-button">Toggle all todos</button><br /><br />
		<button id="add-button">Add</button>
		<input id="add-input" placeholder="text" /><br /><br />
		<button id="edit-button">Edit</button>
		<input id="edit-position-position" placeholder="index" />
		<input id="edit-text-position" placeholder="text" /><br /><br />
		<!-- <button id="remove-button">Remove</button>
		<input id="remove-input" placeholder="index" /><br /><br /> -->
		<!-- <button id="toggle-button">Toggle</button>
		<input id="toggle-input" placeholder="index" /> -->

		<ul id="todo-ul"></ul>

		<script>
			const todos = {
				todoList: [
					{ todoText: 'Item 1', completed: false },
					{ todoText: 'Item 2', completed: false },
					{ todoText: 'Item 3', completed: false },
				],
				add(text) {
					this.todoList.push({ todoText: text, completed: false });
				},
				edit(position, text) {
					this.todoList[position].todoText = text;
				},
				remove(position) {
					this.todoList.splice(position, 1);
				},
				toggle(position) {
					this.todoList[position].completed =
						!this.todoList[position].completed;
				},
				allTrue() {
					for (let i = 0; i < this.todoList.length; i++) {
						if (!this.todoList[i].completed) {
							return false;
						}
					}
					return true;
				},
				toggleAll() {
					let toggleTo = !this.allTrue();
					for (let i = 0; i < this.todoList.length; i++) {
						this.todoList[i].completed = toggleTo;
					}
				},
			};

			displayTodos();

			function displayTodos() {
				let todoList = document.getElementById('todo-ul');

				todoList.innerHTML = '';

				for (let i in todos.todoList) {
					let removeButton = createRemoveButton(i);
					let toggleButton = createToggleButton(i);
					let editButton = createEditButton(i);
					let li = createListItem(i);

					li.appendChild(toggleButton);
					li.appendChild(editButton);
					li.appendChild(removeButton);
					todoList.appendChild(li);
				}
			}

			function createListItem(index) {
				let li = document.createElement('li');
				let todoText = todos.todoList[index].todoText;
				li.innerText =
					(todos.todoList[index].completed ? '✅' : '❌') +
					' ' +
					todoText +
					' ';
				return li;
			}

			function createEditButton(index) {
				let editButton = document.createElement('button');
				editButton.value = index;
				editButton.innerText = 'Edit';
				editButton.addEventListener('click', (e) => {
					const oldText = todos.todoList[index].todoText;
					const newText = window.prompt('Change the old text:', oldText);
					if (newText) {
						todos.edit(e.target.value, newText);
						displayTodos();
					}
				});

				return editButton;
			}

			function createToggleButton(index) {
				let toggleButton = document.createElement('button');
				toggleButton.value = index;
				toggleButton.innerText = 'Toggle';
				toggleButton.addEventListener('click', toggleTodo);
				return toggleButton;
			}

			function createRemoveButton(index) {
				let removeButton = document.createElement('button');
				removeButton.value = index;
				removeButton.innerText = 'Remove';
				removeButton.addEventListener('click', removeTodo);
				return removeButton;
			}

			function toggleTodo(e) {
				todos.toggle(e.currentTarget.value);
				displayTodos();
			}

			function removeTodo(position) {
				todos.remove(position);
				displayTodos();
			}

			let toggleAllButton = document.getElementById('toggle-all-button');
			toggleAllButton.addEventListener('click', () => {
				todos.toggleAll();
				displayTodos();
			});

			let addButton = document.getElementById('add-button');
			addButton.addEventListener('click', () => {
				let addInput = document.getElementById('add-input');
				todos.add(addInput.value);
				addInput.value = '';
				displayTodos();
			});

			let editButton = document.getElementById('edit-button');
			editButton.addEventListener('click', () => {
				let editPositionInput = document.getElementById(
					'edit-position-position'
				);
				let editTextInput = document.getElementById('edit-text-position');
				todos.edit(editPositionInput.value, editTextInput.value);
				editPositionInput.value = '';
				editTextInput.value = '';
				displayTodos();
			});

			let toggleButton = document.getElementById('toggle-button');
		</script>
	</body>
</html>
